<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>Automagical post generation script for Jekyll</title>
   <meta name="author" content="Tao Zhang" />
   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
</head>
<body>
<div id="page">
  <p id="breadcrumbs">
<a href="/">主页</a>
&rsaquo; <a href="/archive/">存档</a>
&rsaquo; Automagical post generation script for Jekyll
</p>
<article>
<header>
<h2><a title="Permalink to Automagical post generation script for Jekyll" href="http://ztnote.com/2011/09/16/automagical-post-generation-script-for-jekyll">Automagical post generation script for Jekyll</a></h2>
<time datetime="2011-09-16" pubdate="pubdate">Sep 16 2011</time>

| <a href="/category#Jekyll">Jekyll</a>

</header>
<p>Jekyll默认的新文章编写方法很让人头疼，你必须新建一个日期+名称.markdown的文件，下面这个小程序可以很方便的根据模版新建post而且自动用vim打开：</p>

<div><script type='text/javascript' src='https://gist.github.com/1223405.js?file='></script>
<noscript><pre><code>#!/usr/bin/env ruby

# *********************************************
# Jekyll Post Generator Awesomeness
# by Cody Krieger (http://codykrieger.com)
# *********************************************

# Usage:
# % ./newpost.rb POST NAME

if ARGV.empty? or ARGV[0].downcase == &quot;--help&quot; or ARGV[0].downcase == &quot;-h&quot;
  puts &lt;&lt;-USAGE

  Usage:
  % ./newpost.rb POST NAME

  USAGE

  exit (ARGV.empty? ? 1 : 0)
end

class String
  
  # from ruby on rails (https://github.com/rails/rails)
  # activesupport/lib/active_support/inflector/transliterate.rb
  def parameterize(sep = '-')
    # replace accented chars with their ascii equivalents
    parameterized_string = self.dup
    # Turn unwanted chars into the separator
    parameterized_string.gsub!(/[^a-z0-9\-_]+/i, sep)
    unless sep.nil? || sep.empty?
      re_sep = Regexp.escape(sep)
      # No more than one of the separator in a row.
      parameterized_string.gsub!(/#{re_sep}{2,}/, sep)
      # Remove leading/trailing separator.
      parameterized_string.gsub!(/^#{re_sep}|#{re_sep}$/i, '')
    end
    parameterized_string.downcase
  end

end

TEMPLATE = &quot;template.markdown&quot;
POSTS_DIR = &quot;_posts&quot;

# Get the title and use it to derive the new filename
title = ARGV.join(&quot; &quot;)
filename = &quot;#{Time.now.strftime('%Y-%m-%d')}-#{title.parameterize}.markdown&quot; 
filepath = File.join(POSTS_DIR, filename)

# Load in the template and set the title
post_text = File.read(TEMPLATE)
post_text.gsub!('%%TITLE%%', title)

# Write out the post
post_file = File.open(filepath, 'w')
post_file.puts post_text
post_file.close

# Open the new post with vim
system(&quot;vim #{filepath}&quot;)
</code></pre></noscript></div>




<footer>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ztnote'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</footer>
</article>
</div>
<div id="footer">
<p id="followme">Follow me: <a href="https://twitter.com/#!/ztpala">Twitter</a> <a href="https://www.facebook.com/taozhang">Facebook</a> | Powered by <a href="https://github.com">GitHub</a> and <a href="https://github.com/mojombo/jekyll">Jekyll</a></p>
</div>
</body>
</html>
