<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
    "http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">

<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en-us">
<head>
   <meta http-equiv="content-type" content="text/html; charset=utf-8" />
   <title>备份Twitter的小程序</title>
   <meta name="author" content="Tao Zhang" />
   <!-- Homepage CSS -->
   <link rel="stylesheet" href="/css/screen.css" type="text/css" media="screen, projection" />
   <script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-5531632-1']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

   </script>
</head>
<body>
<div id="page">
  <p id="breadcrumbs">
<a href="/">主页</a>
&rsaquo; <a href="/archive/">存档</a>
&rsaquo; 备份Twitter的小程序
</p>
<article>
<header>
<h2><a title="Permalink to 备份Twitter的小程序" href="http://ztnote.com/2009/03/27/backup-twitter">备份Twitter的小程序</a></h2>
<time datetime="2009-03-27" pubdate="pubdate">Mar 27 2009</time>

| <a href="/category#WordPressBackup">WordPressBackup</a>

</header>
<p>说明：</p>

<ol>
<li><p>根据每一页显示20条推，然后用总推数/20即可以翻到第一条推那一页。不过发现推数过多的话是翻不到最后一页的，也就是无法备份所有的推。不过我自己总共才有两千多条，所以目前还可以全部下载下来。</p></li>
<li><p>没有使用twitter的API(事实我也没去研究有没有API可以获取所有的推)，直接用Python下载网页源代码里最主要的部分，再加上twitter的css就完工了，很方便，而且显示效果我很满意。</p></li>
</ol>


<p>主要代码如下：</p>

<!--more-->


<pre>import urllib
from BeautifulSoup import BeautifulSoup
// 搜索beautifulsoup python 可以得到这个包的介绍，处理HTML很方便
import re

def getPage(u):
    """get html of the url"""
    response = urllib.urlopen(u)
    source = response.read()
    response.close()
    return source

for i in range(1, 118): //118由推数除以20得到
    u = 'http://twitter.com/ztpala?max_id=1399687141&amp;page=%s&amp;twttr=true' % i
        //这个地址你可以右击你主页最下面的‘more’，复制链接地址
    soup = BeautifulSoup(getPage(u))
    soup.prettify()
    data = str(soup.find('ol', id="timeline"))

    file = open('twitter.html', 'a')
    file.write(data)
    file.close()</pre>


<p>我这两千多条下载下来生成的html文件大概1m，你可以用自己的方式修改一下此代码，比如设定一个文件存多少条推，加上css链接blablabla。</p>

<footer>

<div id="disqus_thread"></div>
<script type="text/javascript">
    /* * * CONFIGURATION VARIABLES: EDIT BEFORE PASTING INTO YOUR WEBPAGE * * */
    var disqus_shortname = 'ztnote'; // required: replace example with your forum shortname

    /* * * DON'T EDIT BELOW THIS LINE * * */
    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = 'http://' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>
</footer>
</article>
</div>
<div id="footer">
<p id="followme">Follow me: <a href="https://twitter.com/#!/ztpala">Twitter</a> <a href="https://www.facebook.com/taozhang">Facebook</a> <a href="http://feeds.feedburner.com/pala">RSS</a> | Powered by <a href="https://github.com">GitHub</a> and <a href="https://github.com/mojombo/jekyll">Jekyll</a></p>
</div>
</body>
</html>
